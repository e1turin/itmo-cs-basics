%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LAB-5 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%>>>>>>>>>>>>>>>>>>>>>>>>>> ПЕРЕМЕННЫЕ >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
%>>>>> Информация о кафедре
%\newcommand{\year}{2021 г.}  % Год устанавливается автоматически
\newcommand{\city}{Санкт-Петербург}  %  Футер, нижний колонтитул на титульном листе
\newcommand{\university}{Национальный исследовательский университет ИТМО}  % первая строка
\newcommand{\department}{Факультет программной инженерии и компьютерной техники}  % Вторая строка
\newcommand{\major}{Направление системного и прикладного программного обеспечения}  % Треьтя строка
%<<<<< Информация о кафедре

%>>>>> Назание работы
\newcommand{\reporttype}{ОТЧЕТ ПО ЛАБОРАТОРНОЙ РАБОТЕ} % тип работы, (главный заголовок титульного листа)
\newcommand{\lab}{Лабораторная работа}          % вид работы
\newcommand{\labnumber}{№ 7}                    % порядковый номер работы
\newcommand{\subject}{Основы профессиональной деятельности}         % учебный предмет
\newcommand{\labtheme}{Исследование работы БЭВМ: микрокоманды и синтез инструкций}            % Тема лабораторной работы
\newcommand{\variant}{№ 1010}                % номер варианта работы

\newcommand{\student}{Тюрин Иван Николаевич}    % определение ФИО студента
\newcommand{\studygroup}{P3110}                 % определение учебной группы 
\newcommand{\teacher}{Клименков С. В.,\\[1mm]     % ФИО лектора
                        Ларочкин Г. И.}          % ФИО практика
%<<<<<<<<<<<<<<<<<<<<<<<<<< ПЕРЕМЕННЫЕ <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


%>>>>>>>>>>>>>>>>>>>>>> ПРЕАМБУЛА >>>>>>>>>>>>>>>>>>>>>>>>>
\include{preamble}
%<<<<<<<<<<<<<<<<<<<<<< ПРЕАМБУЛА <<<<<<<<<<<<<<<<<<<<<<<<<



%%%%%%%%%%%%%%%%%%% СОДЕРЖИМОЕ ОТЧЕТА %%%%%%%%%%%%%%%%%%%%%
%>>>>>>>>>>>>>>> ''''''''''''''''''''''' >>>>>>>>>>>>>>>>>>
\begin{document}


%>>>>>>>>>>>>>>>> ОПРЕДЕЛЕНИЕ НАЗВАНИЙ >>>>>>>>>>>>>>>>>>>>
% Переоформление некоторых стандартных названий
%\renewcommand{\chaptername}{Лабораторная работа}
\renewcommand{\chaptername}{\lab\ \labnumber} % переименование глав
\def\contentsname{Содержание} % переименование оглавления
%<<<<<<<<<<<<<<<< ОПРЕДЕЛЕНИЕ НАЗВАНИЙ <<<<<<<<<<<<<<<<<<<<


%>>>>>>>>>>>>>>>>> ТИТУЛЬНАЯ СТРАНИЦА >>>>>>>>>>>>>>>>>>>>>
\include{titlepage}
%<<<<<<<<<<<<<<<<< ТИТУЛЬНАЯ СТРАНИЦА <<<<<<<<<<<<<<<<<<<<<


%>>>>>>>>>>>>>>>>>>>>> СОДЕРЖАНИЕ >>>>>>>>>>>>>>>>>>>>>>>>>
% Содержание
\tableofcontents
%<<<<<<<<<<<<<<<<<<<<< СОДЕРЖАНИЕ <<<<<<<<<<<<<<<<<<<<<<<<<


%%%%%%%%%%%%%%%%%%%%%%% КОД РАБОТЫ %%%%%%%%%%%%%%%%%%%%%%%%
%>>>>>>>>>>>>>>>>>>>'''''''''''''''''>>>>>>>>>>>>>>>>>>>>>
\newpage
\Chapter{\lab\ \labnumber}{\labtheme}{}

\Section{Задание варианта \variant}
\begin{center}
, , ,
\end{center}
\noindent

\textit{Синтезировать цикл исполнения для выданных преподавателем команд. Разработать тестовые программы, которые проверяют каждую из синтезированных команд. Загрузить в микропрограммную память БЭВМ циклы исполнения синтезированных команд, загрузить в основную память БЭВМ тестовые программы. Проверить и отладить разработанные тестовые программы и микропрограммы.}
\begin{enumerate}
    \item \verb|MSUB M| - вычитание аккумулятора из М с записью результата в ячейку памяти с установкой N/Z/V/C
    \item Код операции - 9...
    \item Тестовая программа должна начинаться с адреса \hex{0481}
\end{enumerate}
\begin{center}
    ' ' '
\end{center}

\newpage

\Section{Описание синтезированной микропрограммы}
В результате выполнения работы была синетзированна следующая микропрограмма, описание которой представлено в таблице \ref{tab:program-desc}.

Запись микропрограммы в код БЭВМ осуществляется следующей командой:\\
\verb|e0 ma mw 0001e09611 mw 8055101040|
\input{program-desc} %%%%%%%%%%% ТАБЛИЦА %%%%%%%%%%

\Section{Текст тестовых прогамм}
Была составлена программа на языке ассемблера для проверки работоспособности синтезированной микропрограммы. Она представлена в листингaх  \ref{lst:script}. Микропрограмма протестирована для различных типов адресаци, в листинге приведен лишь способ прямой адресации. Со всеми типами адресации синтезированная инструкция ведет себя корректно, за исключением прямой загрузки, при которой имеет место неопределенное поведение.

\refstepcounter{lstlisting}
\begin{figure}[h] %- \usepackage {float} %[h]
    \begin{center}
        \lstinputlisting[]{listings/testscript-template.asm}
    \end{center}
    \captionof{lstlisting}{Код тестирующей программы}
    \label{lst:script}  
\end{figure}



\Section{Методика проверки}
Для проверки корректности работы микропрограммы при помощи тестовой программмы была разработана следующая методика:
\begin{enumerate}
    \item Записать значениям для меток X и Y соответственно значения аккумулятора и значение ячейки M памяти с которой требуется провести опеацию \verb|MSUB M|.
    \item Записать значениям для меток \verb|expect.val|, \verb|expect.N| соответственно рассчитанные значения ячейки M и флага N.
    \item Запустить тестирующую программу в автоматическом режиме до остановки.
    \item Проверить значения переменных \verb|check.val|, \verb|check.N|, \verb|check.res| по адресам с \hex{487} до \hex{489}: они все, а в частности последняя должны быть равны 1. В противном случае микропрограмма работает некорректно.
\end{enumerate}


\Section{Трассировка разработанной микропрограммы}
Трасировка разработанной микропрограммы с начала цикла выборки инструкции до начала следующего, выполняющей вычитание 6 из ячейки с адресом \hex{000}, где хранится число \hex{0010} представлена в таблице 1.3.
\Table{tracetable}{Трассировка микропрограммы c момента начала цикла выборки инструкции до начала следующего}{
    \input{tracetable}
}


\Section{Вывод}
Научился синтезировать собственные команды для БЭВМ при помощи размещения в памяти машины дополнительных микрокоманд. Писать тесты для программ на языке BASM, будет тяжело с ним теперь расстаться: мы стали очень близкими друзьми, знаем друг друга очень хорошо. Теперь умею думать как БЭВМ и знаю ее клевые режимы (\verb|-Dmode=dual, -Dmode=cli|).
\newpage
%<<<<<<<<<<<<<<<<<<<<<< КОД РАБОТЫ <<<<<<<<<<<<<<<<<<<<<<<<


%>>>>>>>>>>>>>>>> СПИСОК ЛИТЕРАТУРЫ >>>>>>>>>>>>>>>>>>>>>>>
%\include{biblist}  % Для соответсвия гост, придется доработать. Нужен файл .bib
%<<<<<<<<<<<<<<<<<<<< СПИСОК ЛИТЕРАТУРЫ <<<<<<<<<<<<<<<<<<<


\end{document}
%<<<<<<<<<<<<<<<< ,,,,,,,,,,,,,,,,,,,,,,, <<<<<<<<<<<<<<<<<
%<<<<<<<<<<<<<<<<<<< СОДЕРЖИМОЕ ОТЧЕТА <<<<<<<<<<<<<<<<<<<<
